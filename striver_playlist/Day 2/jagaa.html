<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AirVision Bharat - Interactive Dashboard</title>
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: A two-panel dashboard. The left panel features a large, interactive map of India, serving as the primary exploration tool. The right panel is a dynamic dashboard that updates on map interaction. This structure was chosen to keep the user oriented (on the map) while providing detailed, contextual information in a digestible format. The user flow is simple: explore the map, click a location, and analyze the detailed data that appears. This encourages discovery and makes complex data relationships intuitive. -->
    <!-- Visualization & Content Choices: 
        - Map Interaction (Inform/Explore): A clickable map (simulated) is used instead of a complex library to keep it lightweight. Goal: Allow users to select regions. Method: HTML/JS. Justification: Core interaction for a geo-based app.
        - AQI Card (Inform): A prominent donut-style card. Goal: Highlight the most critical metric. Method: HTML/CSS/JS. Justification: High visual impact.
        - Pollutant Breakdown (Inform): A simple grid of values. Goal: Provide detailed composition. Method: HTML/JS. Justification: Easy scannability.
        - Historical/Forecast Charts (Change): Line and Area charts. Goal: Show trends and predictions. Method: Chart.js. Justification: Standard, effective visualization for time-series data. No SVG/Mermaid used.
        - Health Advisory (Advise): Accordion-style text sections. Goal: Provide actionable advice without cluttering the UI. Method: HTML/JS toggle. Justification: Improves UX by revealing details on demand. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F0F2F5; /* A light, calming neutral */
        }
        .map-container {
            background-image: url('https://www.mapsofindia.com/maps/india/india-political-map.gif');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            width: 100%;
            padding-top: 100%; /* Aspect ratio hack for a square-ish map */
        }
        .map-point {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.2);
        }
        .map-point:hover {
            transform: scale(1.5);
            z-index: 10;
        }
        .map-point.active {
            transform: scale(1.8);
            box-shadow: 0 0 0 4px #3B82F6, 0 0 10px 5px rgba(59, 130, 246, 0.7);
            z-index: 11;
        }
        .chart-container {
            position: relative;
            height: 280px;
            width: 100%;
        }
        @media (min-width: 768px) {
            .map-container {
                padding-top: 0;
                height: 100%;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="app" class="flex flex-col md:flex-row h-screen w-screen">

        <!-- Left Panel: Interactive Map -->
        <div class="w-full md:w-3/5 lg:w-2/3 h-1/3 md:h-full bg-gray-200 flex flex-col">
            <header class="bg-white shadow-md z-10 p-4 flex justify-between items-center">
                <div class="flex items-center">
                    <span class="text-2xl mr-2">ðŸ’¨</span>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">AirVision <span class="text-blue-600">Bharat</span></h1>
                        <p class="text-xs text-gray-500">Hyperlocal Air Quality Intelligence for Underserved India</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="font-semibold text-sm">TEAM MAHAKUMBH</p>
                    <p class="text-xs text-gray-500">ISRO Hackathon 2025</p>
                </div>
            </header>
            <main class="flex-1 relative bg-gray-300">
                <div id="map" class="map-container">
                    <!-- Interactive points will be injected here by JavaScript -->
                </div>
                 <div class="absolute bottom-4 left-4 bg-white/80 backdrop-blur-sm p-2 rounded-lg shadow-lg text-xs">
                    <p class="font-bold mb-1">AQI Legend:</p>
                    <div class="flex items-center mb-1"><div class="w-3 h-3 rounded-full mr-2" style="background-color: #4CAF50;"></div> Good (0-50)</div>
                    <div class="flex items-center mb-1"><div class="w-3 h-3 rounded-full mr-2" style="background-color: #FFEB3B;"></div> Satisfactory (51-100)</div>
                    <div class="flex items-center mb-1"><div class="w-3 h-3 rounded-full mr-2" style="background-color: #FF9800;"></div> Moderate (101-200)</div>
                    <div class="flex items-center mb-1"><div class="w-3 h-3 rounded-full mr-2" style="background-color: #f44336;"></div> Poor (201-300)</div>
                    <div class="flex items-center"><div class="w-3 h-3 rounded-full mr-2" style="background-color: #9C27B0;"></div> Very Poor (301+)</div>
                </div>
            </main>
        </div>

        <!-- Right Panel: Dashboard -->
        <aside id="dashboard" class="w-full md:w-2/5 lg:w-1/3 h-2/3 md:h-full bg-white shadow-2xl overflow-y-auto p-4 md:p-6 space-y-6">
            <!-- Initial State Message -->
            <div id="initial-message" class="flex flex-col items-center justify-center h-full text-center text-gray-500">
                <span class="text-5xl">ðŸ‘†</span>
                <h2 class="mt-4 text-xl font-bold">Select a Location</h2>
                <p class="mt-1">Click on any point on the map to view detailed, hyperlocal air quality data and health advisories.</p>
            </div>

            <!-- Data Display (hidden by default) -->
            <div id="data-display" class="hidden space-y-6">
                <!-- AQI Card -->
                <section id="aqi-card-container"></section>
                
                <!-- Pollutant Breakdown -->
                <section>
                    <h3 class="text-lg font-bold mb-2">Pollutant Breakdown</h3>
                    <div id="pollutants-grid" class="grid grid-cols-3 sm:grid-cols-3 gap-2 text-center">
                        <!-- Pollutant data injected here -->
                    </div>
                </section>

                <!-- Health Advisory -->
                <section>
                    <h3 class="text-lg font-bold mb-2">Health & Wellness Advisory</h3>
                    <div class="space-y-2">
                        <div class="border rounded-lg">
                            <button class="w-full p-3 text-left font-semibold flex justify-between items-center" onclick="toggleAccordion('general-advice')">
                                General Recommendation
                                <span>&#9660;</span>
                            </button>
                            <div id="general-advice" class="p-3 border-t text-sm text-gray-600 hidden"></div>
                        </div>
                        <div class="border rounded-lg">
                            <button class="w-full p-3 text-left font-semibold flex justify-between items-center" onclick="toggleAccordion('ayush-advice')">
                                AYUSH Wellness Tip
                                <span>&#9660;</span>
                            </button>
                            <div id="ayush-advice" class="p-3 border-t text-sm text-gray-600 hidden"></div>
                        </div>
                    </div>
                </section>

                <!-- Historical Data Chart -->
                <section>
                    <h3 class="text-lg font-bold mb-2">Historical AQI (Last 7 Days)</h3>
                    <div class="bg-gray-50 p-2 rounded-lg">
                        <div class="chart-container">
                            <canvas id="historicalChart"></canvas>
                        </div>
                    </div>
                </section>
                
                <!-- Forecast Chart -->
                <section>
                    <h3 class="text-lg font-bold mb-2">72-Hour AQI Forecast</h3>
                    <div class="bg-gray-50 p-2 rounded-lg">
                         <div class="chart-container">
                            <canvas id="forecastChart"></canvas>
                        </div>
                    </div>
                </section>
            </div>
        </aside>

    </div>

    <script>
        const appData = {
            locations: [
                { id: 'delhi', name: 'Delhi', lat: '40%', lon: '30%', isStation: true, aqi: 285, pollutants: { pm25: 285.2, pm10: 390.8, no2: 112.5, so2: 18.3, co: 2.1 }, history: [250, 265, 270, 290, 280, 275, 285], forecast: [290, 295, 305] },
                { id: 'gunupur', name: 'Gunupur, Odisha', lat: '68%', lon: '58%', isStation: false, aqi: 85, pollutants: { pm25: 85.7, pm10: 120.1, no2: 25.4, so2: 8.1, co: 0.8 }, history: [70, 75, 80, 90, 88, 82, 85], forecast: [88, 82, 78] },
                { id: 'mumbai', name: 'Mumbai', lat: '65%', lon: '22%', isStation: true, aqi: 152, pollutants: { pm25: 152.4, pm10: 210.6, no2: 65.1, so2: 15.7, co: 1.4 }, history: [140, 145, 155, 160, 158, 150, 152], forecast: [148, 155, 160] },
                { id: 'kolkata', name: 'Kolkata', lat: '55%', lon: '70%', isStation: true, aqi: 189, pollutants: { pm25: 189.9, pm10: 250.2, no2: 88.3, so2: 20.1, co: 1.9 }, history: [170, 175, 180, 195, 190, 185, 189], forecast: [192, 188, 185] },
                { id: 'chennai', name: 'Chennai', lat: '80%', lon: '40%', isStation: true, aqi: 72, pollutants: { pm25: 72.3, pm10: 95.8, no2: 30.2, so2: 10.5, co: 0.9 }, history: [65, 68, 70, 75, 73, 70, 72], forecast: [70, 68, 75] },
                { id: 'rural_mp', name: 'Rural MP', lat: '50%', lon: '45%', isStation: false, aqi: 121, pollutants: { pm25: 121.5, pm10: 180.3, no2: 40.7, so2: 12.3, co: 1.1 }, history: [110, 115, 120, 125, 122, 118, 121], forecast: [125, 130, 120] }
            ],
            charts: {
                historical: null,
                forecast: null
            }
        };

        const getAQIInfo = (aqi) => {
            if (aqi <= 50) return { category: 'Good', color: '#4CAF50', advice: 'Enjoy outdoor activities.', ayush: 'The air is fresh. A perfect day for outdoor yoga (Surya Namaskar).' };
            if (aqi <= 100) return { category: 'Satisfactory', color: '#FFEB3B', advice: 'Unusually sensitive people should consider reducing prolonged or heavy exertion.', ayush: 'Air quality is acceptable. A morning walk is fine. Consider drinking Tulsi tea.' };
            if (aqi <= 200) return { category: 'Moderate', color: '#FF9800', advice: 'Children, elderly, and individuals with heart or lung disease should reduce prolonged exertion.', ayush: 'Sensitive groups may feel effects. Practice indoor Pranayama. A diet with ginger and turmeric is beneficial.' };
            if (aqi <= 300) return { category: 'Poor', color: '#f44336', advice: 'Everyone should reduce prolonged exertion. It\'s advisable to wear a mask outdoors.', ayush: 'Unhealthy air. Avoid outdoor activities. Gargle with warm salt water.' };
            return { category: 'Very Poor', color: '#9C27B0', advice: 'Everyone should avoid all physical activity outdoors. Vulnerable groups should remain indoors.', ayush: 'Very unhealthy. Remain indoors. Drink \'Kadha\' (herbal decoction) to boost immunity.' };
        };

        const updateDashboard = (location) => {
            const aqiInfo = getAQIInfo(location.aqi);

            // Update AQI Card
            const aqiCardContainer = document.getElementById('aqi-card-container');
            aqiCardContainer.innerHTML = `
                <div class="bg-white p-4 rounded-lg shadow-md border-l-4" style="border-color: ${aqiInfo.color};">
                    <h2 class="text-xl font-bold text-gray-900">${location.name}</h2>
                    <p class="text-sm font-semibold" style="color: ${aqiInfo.color};">${location.isStation ? 'â—‰ From Ground Station' : 'ðŸ’¨ Hyperlocal AI Prediction'}</p>
                    <div class="flex items-center justify-center my-4">
                        <div class="w-32 h-32 rounded-full flex flex-col items-center justify-center border-8" style="border-color: ${aqiInfo.color};">
                            <span class="text-4xl font-bold text-gray-900">${location.aqi}</span>
                            <span class="text-sm font-semibold" style="color: ${aqiInfo.color};">${aqiInfo.category}</span>
                        </div>
                    </div>
                </div>`;

            // Update Pollutants
            const pollutantsGrid = document.getElementById('pollutants-grid');
            pollutantsGrid.innerHTML = `
                <div class="bg-gray-100 p-2 rounded"><div class="font-bold text-gray-700 text-sm">PM2.5</div><div class="text-gray-600">${location.pollutants.pm25}</div></div>
                <div class="bg-gray-100 p-2 rounded"><div class="font-bold text-gray-700 text-sm">PM10</div><div class="text-gray-600">${location.pollutants.pm10}</div></div>
                <div class="bg-gray-100 p-2 rounded"><div class="font-bold text-gray-700 text-sm">NOâ‚‚</div><div class="text-gray-600">${location.pollutants.no2}</div></div>
                <div class="bg-gray-100 p-2 rounded"><div class="font-bold text-gray-700 text-sm">SOâ‚‚</div><div class="text-gray-600">${location.pollutants.so2}</div></div>
                <div class="bg-gray-100 p-2 rounded"><div class="font-bold text-gray-700 text-sm">CO</div><div class="text-gray-600">${location.pollutants.co}</div></div>
            `;

            // Update Health Advisory
            document.getElementById('general-advice').textContent = aqiInfo.advice;
            document.getElementById('ayush-advice').textContent = aqiInfo.ayush;
            
            // Show the data display
            document.getElementById('initial-message').classList.add('hidden');
            document.getElementById('data-display').classList.remove('hidden');

            // Update Charts
            updateCharts(location);
        };

        const createChart = (ctx, type, labels, datasets) => {
            return new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            bodyFont: { size: 12 },
                            titleFont: { size: 14 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        };
        
        const updateCharts = (location) => {
            const historicalLabels = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Today'];
            const forecastLabels = ['+24h', '+48h', '+72h'];
            
            // Destroy old charts if they exist
            if (appData.charts.historical) appData.charts.historical.destroy();
            if (appData.charts.forecast) appData.charts.forecast.destroy();

            // Historical Chart
            const histCtx = document.getElementById('historicalChart').getContext('2d');
            appData.charts.historical = createChart(histCtx, 'line', historicalLabels, [{
                label: 'AQI',
                data: location.history,
                borderColor: '#3B82F6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                fill: true,
                tension: 0.3
            }]);

            // Forecast Chart
            const forecastCtx = document.getElementById('forecastChart').getContext('2d');
            appData.charts.forecast = createChart(forecastCtx, 'bar', forecastLabels, [{
                label: 'Forecasted AQI',
                data: location.forecast,
                backgroundColor: ['#6EE7B7', '#34D399', '#059669'],
                borderRadius: 4
            }]);
        };
        
        const initMapPoints = () => {
            const mapElement = document.getElementById('map');
            appData.locations.forEach(loc => {
                const point = document.createElement('div');
                point.className = 'map-point';
                point.style.top = loc.lat;
                point.style.left = loc.lon;
                point.style.backgroundColor = getAQIInfo(loc.aqi).color;
                point.dataset.locationId = loc.id;
                point.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const locationId = e.target.dataset.locationId;
                    
                    // Update active state
                    document.querySelectorAll('.map-point').forEach(p => p.classList.remove('active'));
                    e.target.classList.add('active');

                    const locationData = appData.locations.find(l => l.id === locationId);
                    if (locationData) {
                        updateDashboard(locationData);
                    }
                });
                mapElement.appendChild(point);
            });
        };
        
        const toggleAccordion = (id) => {
            const element = document.getElementById(id);
            element.classList.toggle('hidden');
        };

        window.onload = () => {
            initMapPoints();
        };

    </script>
</body>
</html>
